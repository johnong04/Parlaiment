# Development Checklist

## Phase 1: Data Ingestion (The Foundation)

- [x] **Setup:** Initialize Python environment (`requirements.txt`: streamlit, pdfplumber, pandas, bertopic, torch).
- [x] **Script:** Create `src/parser.py` using `pdfplumber` to extract `[Speaker, Text]` from a single PDF.
- [x] **Refine:** Test parser on `DR-15102018.pdf` and fix Regex to handle multi-line speeches correctly.
- [x] **Scale:** Run parser on the full folder of 29 selected PDFs.
- [x] **Metadata:** Create `data/party_map.csv` (using LLM to map names to parties) and merge with speech data.
- [x] **Finalize:** Save clean dataset to `data/hansard_master_final.csv`.

## Phase 2: Modeling (The Brain)

- [x] **Topic Model:** Run BERTopic on `hansard_master.csv`.
- [x] **Topic Map:** Create a manual dictionary to rename top topics. (Note: Topic 0: Banter, Topic 5: Education, etc.)
- [x] **Evaluation:** Calculated Coherence Score (Cv = 0.3909).
- [x] **Stance Generation:** Run LLM script on top interesting rows to generate `Stance` column (Pro/Con/Neutral/Evasive). (Note: `gold_stance_data.csv` generated by Manus AI)
- [x] **Integration:** Train stance classifier and predict for full dataset. (Note: XLM-RoBERTa fine-tuned to 69% accuracy).
- [x] **Final Enriched CSV:** Verify `hansard_final_analyzed.csv` is in `data/`.

## Phase 3: Dashboard Implementation (The Face)

- [x] **Setup:** Create `app.py` with Streamlit layout (Full-width, No Sidebar).
- [x] **Tab 1 (Trends):** Implement Line Chart for Topic Trends with Evasiveness Index overlay.
- [x] **Tab 2 (Stance):** Implement Stacked Bar Chart and Heatmap (Topic vs Party) for accountability scoring.
- [x] **Tab 3 (Explorer):** Implement Searchable Dataframe with keyword highlighting and Stance Detail Cards.
- [x] **Tab 4 (MP Insights):** Implement individual MP Profiler with Stance distribution and Topic Chips.
- [x] **Tab 5 (Methodology):** Create professional academic section explaining the AI pipeline (BERTopic + XLM-RoBERTa).
- [x] **UI Polish:** Applied "ParlAIment" branding with high-end Deep Dark theme (Navy/Gold).

## Phase 4: The "Demo" Magic (Smart Features)

- [x] **MP Profiler:** Highly visual "Player Card" design with Stance Pie Charts and Topic Chips.
- [x] **Accountability Heatmap:** Color-coded grid showing Evasiveness Index across Parties and Top 10 Topics.
- [x] **Keyword Highlighting:** Dynamic regex-based text highlighting in search results for better UX.
- [x] **Noise Suppression:** Integrated master filter for 24+ procedural/banter topics to ensure data purity.

## Phase 5: Submission Prep

- [x] **Testing:** Verified 100% functional data flow and stable UI components.
- [x] **Screenshots:** Captured the new "ParlAIment" header and Stance Heatmap for final deck.

---

## AI Notes / Context Memory

- **Note 1:** We are skipping pages 1-10 of PDFs (admin lists) implicitly via noise filtering.
- **Note 2:** Date is extracted from filenames (e.g., `DR-15102018.pdf` -> `15-10-2018`).
- **Note 3:** If BERTopic installation fails on dependencies, use a simple keyword-based topic assignment fallback for the demo.
- **Note 4:** "Evasive" is the most important class to highlight visually.
- **Context Memory (2026-01-11):**
  - Refined `SPEAKER_REGEX` to `^([A-Z][\w\s\'\.\-@]{2,60})(?:\s*\[(.*?)\])?\s*:` to avoid capturing long sentences.
  - Added `SPEAKER_BLACKLIST` (e.g., 'MELULUSKAN', 'USUL') to handle false positives from table of contents and procedural text.
  - Parser uses a state machine to group multi-line text under the correct speaker until the next speaker pattern is found.
